# Create kubeshark Helm release
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: kubeshark
spec:
  chart:
    spec:
      # Use this chart from the repository
      chart: kubeshark
      # Pin version to major
      version: "52.x"
      # Use this Helm repository
      sourceRef:
        kind: HelmRepository
        name: kubeshark
  # This key always needs to be here for patching to work
  postRenderers: []
  values:
    tap:
      gitops:
        # Enable GitOps mode to preserve dynamic configuration
        enabled: true
      resourceGuard:
        # Enable stopping traffic capture on insufficient resources
        enabled: true
      telemetry:
        # Disable telemetry
        enabled: false
